<!DOCTYPE html>
<html lang="en" xmlns:vertical-align="http://www.w3.org/1999/xhtml" xmlns:left="http://www.w3.org/1999/xhtml"
      xmlns:top="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>青软商城-注册</title>
    <link rel="stylesheet" href="../../static/css/common.css">
    <link rel="stylesheet" href="../../static/css/login.css">
    <link rel="stylesheet" href="../../static/css/style.css">
</head>
<body>
<div class="top center">
    <div class="logo center">
        <a href="./index.html" target="_blank"><img src="../../static/goods-img/login-logo-2.png" alt=""></a>
    </div>
</div>
<div id="particles-js" class="form center">
    <!--<div class="form_register center">-->
    <div class="login">
        <div class="login_center">
            <div class="login_top">
                <div class="left fl">会员注册</div>
                <div class="clear"></div>
                <div class="under-line center"></div>
            </div>
            <form id="registerForm" action="">
                <div class="login_main center">
                    <div class="login-info">手机号:&nbsp;<input class="login-info-input"
                                                             id="id_number"
                                                             type="text"
                                                             name="username"
                                                             placeholder="请输入你的手机号"/>
                    </div>
                    <div class="login-info">密&nbsp;&nbsp;&nbsp;&nbsp;码:&nbsp;<input class="login-info-input"
                                                                                    id="password"
                                                                                    type="password"
                                                                                    name="password"
                                                                                    placeholder="请输入你的密码"/>
                    </div>
                    <div class="login-info"
                         style="margin-top: 0px">
                        验证码:
                        <input class="login-info-input"
                               id="verification_code"
                               type="text"
                               style="width: 110px; vertical-align: middle"
                               name="verification_code"
                               placeholder="请输入验证码"/>
                        <img class=""
                             id="check_code"
                             src="../checkCode/creatCheckCode"
                             style="width: 105px; height: 42px; vertical-align: middle"
                             name="check_code">
                        <!--                        <input class="login-info-input"-->
                        <!--                               type="submit"-->
                        <!--                               style="width: 98px; height: 42px; border: 0px"-->
                        <!--                               value="获取验证码"/>-->
                    </div>

                </div>
                <div class="login_submit">
                    <!--                                        <input class="submit" type="button" onclick="register()" value="立即注册">-->
                    <input id="register_button" class="submit" type="button" value="立即注册">
                </div>
            </form>
        </div>
    </div>
</div>
</body>

<script src="../../static/js/particles.min.js"></script>
<script src="../../static/js/app.js"></script>

<!-- jQuery -->
<script src="../../static/plugin/jquery/jquery.min.js"></script>
<script src="../../static/js/public.js"></script>
<script src="../../static/plugin/sweetalert/sweetalert.min.js"></script>

<script>
    $(function () {
        //验证码图片点击事件
        $("#check_code").click(function () {
            //获取当前时间
            var date = new Date().getTime();
            //为验证码图片加时间戳
            document.getElementById("check_code").src = "../checkCode/creatCheckCode?" + date;
        })

        //注册按钮点击事件
        $("#register_button").click(function () {
            //获取用户手机号
            var username = $("#id_number").val();
            //判断手机号是否合法
            if (!validPhoneNumber(username)) {//手机号不合法
                swal('请输入正确的手机号', {
                    icon: "error",
                });
                return false;
            }
            //手机号合法
            //获取用户密码
            var password = $("#password").val();
            //判断密码是否合法
            if (!validPassword(password)) {//棉麻不合法
                swal('请输入正确的密码格式(6-20位字符和数字组合)', {
                    icon: "error",
                });
                return false;
            }
            //密码合法


            //异步通信
            //将表单提交到服务器进行注册业务
            $.post("register", $("#registerForm").serialize(), function (data) {
                alert(data);
                if (data === "checkCode_expired") {//服务器返回的数据为checkCode_expired
                    //验证码已过期
                    swal('验证码已过期，请重新获取验证码', {
                        icon: "error",
                    });
                    return false;
                }
                if (data === "checkCode_error") {//服务器返回的数据为checkCode_error
                    //验证码错误
                    swal('验证码错误,请重新获取验证码', {
                        icon: "error",
                    });
                    return false;
                }
                if (data === "register_success") {//服务器返回的数据为register_success
                    //注册成功，跳转到登录界面
                    swal({
                        title: "注册成功",
                        text: "是否跳转至登录页?",
                        icon: "success",
                        buttons: true,
                    }).then((flag) => {
                        if (flag) {
                            window.location.href = '/user/login.html';
                        }
                    });

                }
                if (data === "register_error") {//服务器返回的数据为register_error
                    //注册失败，用户名已存在
                    swal('注册失败，用户名已存在', {
                        icon: "error",
                    });
                    return false;
                }
            })
        })
    });
</script>

<!--<script type="text/javascript">-->

<!--    //注册按钮onclick事件改为register()即可-->
<!--    function register() {-->
<!--        var username = $("#id_number").val();-->
<!--        alert(username);-->
<!--        if (!validPhoneNumber(username)) {-->
<!--            swal('请输入正确的手机号', {-->
<!--                icon: "error",-->
<!--            });-->
<!--            return false;-->
<!--        }-->
<!--        var password = $("#password").val();-->
<!--        if (!validPassword(password)) {-->
<!--            swal('请输入正确的密码格式(6-20位字符和数字组合)', {-->
<!--                icon: "error",-->
<!--            });-->
<!--            return false;-->
<!--        }-->
<!--        var verifyCode = $("#verifyCode").val();-->
<!--        if (!validLength(verifyCode, 6)) {-->
<!--            swal('请输入正确的验证码', {-->
<!--                icon: "error",-->
<!--            });-->
<!--            return false;-->
<!--        }-->
<!--        -->
<!--        //验证-->
<!--        var params = $("#registerForm").serialize();-->
<!--        $.ajax({-->
<!--            type: 'POST',//方法类型-->
<!--            url: '/user/register',-->
<!--            data: params,-->
<!--            success: function (register) {-->
<!--                if (register == true) {-->
<!--                    swal({-->
<!--                        title: "注册成功",-->
<!--                        text: "是否跳转至登录页?",-->
<!--                        icon: "success",-->
<!--                        buttons: true,-->
<!--                        /*dangerMode: true,*/-->
<!--                    }).then((flag) => {-->
<!--                            if (flag) {-->
<!--                                window.location.href = '/login.html';-->
<!--                            }-->
<!--                        }-->
<!--                    );-->
<!--                } else {-->
<!--                    swal({-->
<!--                        icon: "error",-->
<!--                    });-->
<!--                }-->
<!--                ;-->
<!--            },-->
<!--            error: function () {-->
<!--                swal({-->
<!--                    title: "操作失败",-->
<!--                    icon: "error",-->
<!--                });-->
<!--            }-->
<!--        });-->
<!--    }-->


<!--    function btnChange() {-->
<!--        $("#pass-button").addClass("on");-->
<!--        var time = 60;-->
<!--        $("#pass-button").attr("disabled", true);-->
<!--        var timer = setInterval(function () {-->
<!--            if (time == 0) {-->
<!--                clearInterval(timer);-->
<!--                $("#pass-button").attr("disabled", false);-->
<!--                $("#pass-button").val("重新获取");-->
<!--                $("#pass-button").removeClass("on");-->
<!--            } else {-->
<!--                $('#pass-button').val(time + "(S)");-->
<!--                time&#45;&#45;;-->
<!--            }-->
<!--        }, 1000);-->
<!--    }-->

<!--    $("#pass-button").click(function () {-->
<!--        var loginName = $("#loginName").val();-->
<!--        if (!validPhoneNumber(loginName)) {-->
<!--            swal('请输入正确的手机号', {-->
<!--                icon: "error",-->
<!--            });-->
<!--            return false;-->
<!--        }-->
<!--        btnChange();-->
<!--        $.ajax({-->
<!--            type: "get",-->
<!--            url: "/getOtp",-->
<!--            data: {-->
<!--                "loginName": loginName-->
<!--            },-->
<!--            success: function (result) {-->
<!--                if (result.resultCode != 200) {-->
<!--                    swal(result.message, {-->
<!--                        icon: "error",-->
<!--                    });-->
<!--                }-->
<!--                ;-->
<!--            },-->
<!--            error: function () {-->
<!--                swal("操作失败", {-->
<!--                    icon: "error",-->
<!--                });-->
<!--            }-->
<!--        });-->
<!--    });-->

<!--</script>-->


</html>